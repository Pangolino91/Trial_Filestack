<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://static.filestackapi.com/v3/filestack.js"></script>
    <link rel="stylesheet" href="css/style.css">
    <title>Filestack</title>
</head>
<body>
  <script src="https://static.filestackapi.com/filestack-js/1.x.x/filestack.min.js"></script>

  <script>
      
      // defining variables 
      const apikey = 'AbIBhlmnR0iVZ8E1iHS9Ez';
      const client = filestack.init(apikey);


      // playground

      function playground () {
      //  var dogs = ['pug', 'labs', 'setters'];
      //  var multipleSshit = dogs.map(el => el * 3);
      //  var hhh = dogs.indexOf()
      //  var fff = document.createElement('div');
      //  console.log(hhh)
      var att = document.getElementsByClassName("prova");
      var born = document.createElement("div")
      born.innerHTML = 'SSSSS';
      }

      playground();

      // the dump
      // element.mimetype === 'image/png'



      window.addEventListener('DOMContentLoaded', function () {
      const options = {
        maxFiles: 5,
        uploadInBackground: false,
        onOpen: () => console.log('opened!'),
        onUploadDone: (res) => {
          console.log(res);
          displayImage(res);
          // client.preview(res.filesUploaded[0].handle)
        },
        onClose: function() {console.log('prova')}
      };
      
      client.picker(options).open();
      
          function displayImage(res) {

            // identify the res element
            var fileData = res.filesUploaded;
            
            //  defining constants regarding the type of the file
            var imageArray = ['png', 'jpg', 'jpeg'];
            const documentArray = ['application/json', 'application/pdf', 'application/vnd.ms-powerpoint', 'application/vnd.ms-powerpoint', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.ms-excel', 'text/html'] 
            fileData.forEach(element => {
            // constants.... 
            console.log(element)
            var domContainer = document.getElementById('thumbnail-container');
            var containerCreate = document.createElement("a")
            containerCreate.setAttribute("id", element.uploadId)
            containerCreate.className = "container"
            containerCreate.href = element.url
            containerCreate.target = "_blank"
            domContainer.appendChild(containerCreate)
            // var container = document.querySelector(".container")
            
            
            var p = document.createElement("p");
            p.innerText = element.filename;
            containerCreate.appendChild(p);
            

            if (['png', 'jpg'].indexOf(fileData.mimetype.split('/')[1]) !== -1) {
                var container = document.getElementById(element.uploadId);
                var thumbnail = new Image();
                thumbnail.id = 'thumbnail';
                thumbnail.src = client.transform(element.handle, {
                  resize: {
                    width: 200
                  }
                })
                container.appendChild(thumbnail);
            }
            
          });
        console.log(fileData);
        }  
    

        // // fileData.forEach(el => {
        // // var newArray = [];
        // // var prova = el.mimetype === 'jpeg' ||	'png';
        // // newArray.push(prova)
        // // console.log(newArray)
        // // })

        //   if (['jpeg', 'png'].indexOf(fileData.mimetype.split('/')[1]) !== -1) {
        //   const container = document.getElementById('thumbnail-container');
        //   const thumbnail = document.getElementById('thumbnail') || new Image();
        //   thumbnail.id = 'thumbnail';
        //   thumbnail.src = client.transform(fileData.handle, { 
        //     resize: { 
        //       width: 200 
        //     }
        //   });

        //   if (!container.contains(thumbnail)) {
        //     container.appendChild(thumbnail);
        //   }
        // }

      
    })
      
  </script>
  
  <div id="title">Filestack</div>
      <div id="thumbnail-container">
  </div>


</body>
</html>

